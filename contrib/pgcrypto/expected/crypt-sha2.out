--
-- crypt() and gen_salt(): sha256/512
--
-- Ulrich's test cases for SHA256
select crypt('Hello world!', '$5$saltstring');
                           crypt                           
-----------------------------------------------------------
 $5$saltstring$5B8vYYiY.CVt1RlTTf8KbXBH3hsxY/GNooZaBBGWEc5
(1 row)

-- $5$saltstring$5B8vYYiY.CVt1RlTTf8KbXBH3hsxY/GNooZaBBGWEc5
select crypt('Hello world!', '$5$rounds=10000$saltstringsaltstring');
                                    crypt                                     
------------------------------------------------------------------------------
 $5$rounds=10000$saltstringsaltst$3xv.VbSHBb41AL9AvLeujZkZRBAwqFMz2.opqey6IcA
(1 row)

-- $5$rounds=10000$saltstringsaltst$3xv.VbSHBb41AL9AvLeujZkZRBAwqFMz2.opqey6IcA
select crypt('This is just a test', '$5$rounds=5000$toolongsaltstring');
                                    crypt                                    
-----------------------------------------------------------------------------
 $5$rounds=5000$toolongsaltstrin$Un/5jzAHMgOGZ5.mWJpuVolil07guHPvOW8mGRcvxa5
(1 row)

-- $5$rounds=5000$toolongsaltstrin$Un/5jzAHMgOGZ5.mWJpuVolil07guHPvOW8mGRcvxa5
select crypt('a very much longer text to encrypt.  This one even stretches over morethan one line.',
             '$5$rounds=1400$anotherlongsaltstring');
                                    crypt                                    
-----------------------------------------------------------------------------
 $5$rounds=1400$anotherlongsalts$Rx.j8H.h8HjEDGomFU8bDkXm3XIUnzyxf12oP84Bnq1
(1 row)

--$5$rounds=1400$anotherlongsalts$Rx.j8H.h8HjEDGomFU8bDkXm3XIUnzyxf12oP84Bnq1
select crypt('we have a short salt string but not a short password', '$5$rounds=77777$short');
                               crypt                               
-------------------------------------------------------------------
 $5$rounds=77777$short$JiO1O3ZpDAxGJeaDIuqCoEFysAe1mZNJRs3pw0KQRd/
(1 row)

-- $5$rounds=77777$short$JiO1O3ZpDAxGJeaDIuqCoEFysAe1mZNJRs3pw0KQRd/
select crypt('a short string', '$5$rounds=123456$asaltof16chars..');
                                     crypt                                     
-------------------------------------------------------------------------------
 $5$rounds=123456$asaltof16chars..$gP3VQ/6X7UUEW3HkBn2w1/Ptq2jxPyzV/cZKmF/wJvD
(1 row)

-- $5$rounds=123456$asaltof16chars..$gP3VQ/6X7UUEW3HkBn2w1/Ptq2jxPyzV/cZKmF/wJvD
select crypt('the minimum number is still observed', '$5$rounds=10$roundstoolow');
                                  crypt                                  
-------------------------------------------------------------------------
 $5$rounds=1000$roundstoolow$yfvwcWrQ8l/K0DAWyuPMDNHpIVlTQebY9l/gL972bIC
(1 row)

-- $5$rounds=1000$roundstoolow$yfvwcWrQ8l/K0DAWyuPMDNHpIVlTQebY9l/gL972bIC
-- Ulrich's test cases for SHA512
select crypt('Hello world!', '$6$saltstring');
                                                crypt                                                 
------------------------------------------------------------------------------------------------------
 $6$saltstring$svn8UoSVapNtMuq1ukKS4tPQd8iKwSMHWjl/O817G3uBnIFNjnQJuesI68u4OTLiBFdcbYEdFCoEOfaS35inz1
(1 row)

-- $6$saltstring$svn8UoSVapNtMuq1ukKS4tPQd8iKwSMHWjl/O817G3uBnIFNjnQJuesI68u4OTLiBFdcbYEdFCoEOfaS35inz1
select crypt('Hello world!', '$6$rounds=10000$saltstringsaltstring');
                                                          crypt                                                          
-------------------------------------------------------------------------------------------------------------------------
 $6$rounds=10000$saltstringsaltst$OW1/O6BYHV6BcXZu8QVeXbDWra3Oeqh0sbHbbMCVNSnCM/UrjmM0Dp8vOuZeHBy/YTBmSK6H9qs/y3RnOaw5v.
(1 row)

-- $6$rounds=10000$saltstringsaltst$OW1/O6BYHV6BcXZu8QVeXbDWra3Oeqh0sbHbbMCVNSnCM/UrjmM0Dp8vOuZeHBy/YTBmSK6H9qs/y3RnOaw5v.
select crypt('This is just a test', '$6$rounds=5000$toolongsaltstring');
                                                         crypt                                                          
------------------------------------------------------------------------------------------------------------------------
 $6$rounds=5000$toolongsaltstrin$lQ8jolhgVRVhY4b5pZKaysCLi0QBxGoNeKQzQ3glMhwllF7oGDZxUhx1yxdYcz/e1JSbq3y6JMxxl8audkUEm0
(1 row)

-- $6$rounds=5000$toolongsaltstrin$lQ8jolhgVRVhY4b5pZKaysCLi0QBxGoNeKQzQ3glMhwllF7oGDZxUhx1yxdYcz/e1JSbq3y6JMxxl8audkUEm0
select crypt('a very much longer text to encrypt.  This one even stretches over morethan one line.',
             '$6$rounds=1400$anotherlongsaltstring');
                                                         crypt                                                          
------------------------------------------------------------------------------------------------------------------------
 $6$rounds=1400$anotherlongsalts$POfYwTEok97VWcjxIiSOjiykti.o/pQs.wPvMxQ6Fm7I6IoYN3CmLs66x9t0oSwbtEW7o7UmJEiDwGqd8p4ur1
(1 row)

-- $6$rounds=1400$anotherlongsalts$POfYwTEok97VWcjxIiSOjiykti.o/pQs.wPvMxQ6Fm7I6IoYN3CmLs66x9t0oSwbtEW7o7UmJEiDwGqd8p4ur1
select crypt('we have a short salt string but not a short password', '$6$rounds=77777$short');
                                                    crypt                                                     
--------------------------------------------------------------------------------------------------------------
 $6$rounds=77777$short$WuQyW2YR.hBNpjjRhpYD/ifIw05xdfeEyQoMxIXbkvr0gge1a1x3yRULJ5CCaUeOxFmtlcGZelFl5CxtgfiAc0
(1 row)

-- $6$rounds=77777$short$WuQyW2YR.hBNpjjRhpYD/ifIw05xdfeEyQoMxIXbkvr0gge1a1x3yRULJ5CCaUeOxFmtlcGZelFl5CxtgfiAc0
select crypt('a short string', '$6$rounds=123456$asaltof16chars..');
                                                          crypt                                                           
--------------------------------------------------------------------------------------------------------------------------
 $6$rounds=123456$asaltof16chars..$BtCwjqMJGx5hrJhZywWvt0RLE8uZ4oPwcelCjmw2kSYu.Ec6ycULevoBK25fs2xXgMNrCzIMVcgEJAstJeonj1
(1 row)

-- $6$rounds=123456$asaltof16chars..$BtCwjqMJGx5hrJhZywWvt0RLE8uZ4oPwcelCjmw2kSYu.Ec6ycULevoBK25fs2xXgMNrCzIMVcgEJAstJeonj1
select crypt('the minimum number is still observed', '$6$rounds=10$roundstoolow');
                                                       crypt                                                        
--------------------------------------------------------------------------------------------------------------------
 $6$rounds=1000$roundstoolow$kUMsbe306n21p9R.FRkW3IGn.S9NPN0x50YhH1xhLsPuWGsUSklZt58jaTfF4ZEQpyUNGc0dqbpBYYBaHHrsX.
(1 row)

-- $6$rounds=1000$roundstoolow$kUMsbe306n21p9R.FRkW3IGn.S9NPN0x50YhH1xhLsPuWGsUSklZt58jaTfF4ZEQpyUNGc0dqbpBYYBaHHrsX.
--
-- random tests
--
select crypt('', '$5$');
                      crypt                      
-------------------------------------------------
 $5$$3c2QQ0KjIU1OLtB29cl8Fplc2WN7X89bnoEjaR7tWu.
(1 row)

select crypt('', '$6$');
                                           crypt                                            
--------------------------------------------------------------------------------------------
 $6$$/chiBau24cE26QQVW3IfIe68Xu5.JQ4E8Ie7lcRLwqxO5cxGuBhqF2HmTL.zWJ9zjChg3yJYFXeGBQ2y3Ba1d1
(1 row)

select crypt('', '$5$salt');
                        crypt                        
-----------------------------------------------------
 $5$salt$HrcUzzoef72uxM/YhTU5BAi419Fblqlq//zyM.rIOG0
(1 row)

select crypt('', '$6$salt');
                                             crypt                                              
------------------------------------------------------------------------------------------------
 $6$salt$r6qPcj2UeIkfklWHvleGJk8OKTInFYR/fxyuwcC656IWiZBpIFZ9.hMRG2ZQnnyMFrKOe461f9iT9Ljn0wJ5l.
(1 row)

select crypt('a', '$5$');
                      crypt                      
-------------------------------------------------
 $5$$QG6CCM7eJAxpUPcBpn0Z2K29NHtaI6Mk1fCpPrpjdj3
(1 row)

select crypt('a', '$6$');
                                           crypt                                            
--------------------------------------------------------------------------------------------
 $6$$ek/ucQg0IM8SQLyD2D66mpoW0vAF26eA0/pqoN95V.F0nZh1IFuENNo0OikacRkDBk5frNqziMYMdVVrQ0o.51
(1 row)

select crypt('a', '$5$salt');
                        crypt                        
-----------------------------------------------------
 $5$salt$7p0.o3bzi2h7d5cGlDeRN33gONQRpRi7aNgP2TFs9a5
(1 row)

select crypt('a', '$6$salt');
                                             crypt                                              
------------------------------------------------------------------------------------------------
 $6$salt$TfbP0Ge1gqNJmxZYvNhvDmmKx9BigkML6b3w1kfEiAHpkKpCRu.SKIYV70wlcWGmbdh1koH3a0UmC0b0AcWDQ0
(1 row)

